#    Game-in-a-box. Simple First Person Shooter Network Game.
#    Copyright (C) 2012-2013 Richard Maxwell <jodi.the.tigger@gmail.com>
#
#    This file is part of Game-in-a-box
#
#    Game-in-a-box is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as published by
#    the Free Software Foundation, either version 3 of the License, or
#    (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>
 
language: cpp
compiler:
  - clang
  - gcc

install:
# Need gcc 4.8.1, have to jump a few hoops to do that.


# Clang dependencies
# - if [ $CXX = "clang++" ]; then sudo apt-get install -qq libstdc++-4.8-dev clang-3.2; fi

# GCC dependencies
# I'm building with GCC 4.8.1 getting that on travis ci is a bit of work.
 - if [ $CXX = "g++" ]; then
   sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test;
   sudo apt-get update -qq;
   sudo update-alternatives --remove-all gcc;
   sudo update-alternatives --remove-all g++;
   sudo apt-get install -qq gcc-4.8.1 g++-4.8.1;
   sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.8.1 20;
   sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.8.1 20;
   sudo update-alternatives --auto gcc;
   sudo update-alternatives --auto g++;
   fi;

# RAM: TODO: Needed?
# - sudo update-alternatives --config --skip-auto
# - sudo update-alternatives --config --skip-auto

# libraries needed for everything else.
 - sudo apt-get -q install cmake valgrind libboost-dev libboost-system-dev libboost-thread-dev

script:
  - mkdir build
  - cd build
  - cmake ../
  - make

# RAM: TODO: Make a supression file for all the gmock warnings.
#after_success:
# - valgrind --leak-check=full --show-reachable=yes ./game-in-a-box-common-tests

